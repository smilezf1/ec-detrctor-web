webpackJsonp([8],{DAWu:function(e,t){},DRvd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("47tL"),s={name:"authorizationManagement",inject:["reload"],data:function(){return{name:"authorizeManagement",listItem:null,userCode:null,uploadAuthorizeFileDrawer:!1}},beforeMount:function(){var e=this;i.a.authorizeService.authorizeManageList().then(function(t){"00"==t.code&&(e.listItem=t.data,e.userCode=t.data.userCode)})},methods:{getUserCode:function(){var e=this;i.a.authorizeService.getUserCode().then(function(t){"00"==t.code&&(e.userCode=t.data)})},uploadAuthorize:function(){this.uploadAuthorizeFileDrawer=!0},uploadAuthorizeFile:function(e){var t=this,a=this,s=new FormData;s.append("file",e.file);var r={onUploadProgress:function(t){var a=t.loaded/t.total*100|0;e.onProgress({percent:a})}};i.a.uploadService.uploadAuthorizeFile(s,r).then(function(e){if("01"!=e.code&&"99"!=e.code&&"500"!=e.code||(a.uploadAuthorizeFileDrawer=!1,a.$refs.upload.clearFiles()),"00"==e.code){a.$notify({message:"上传授权文件成功!",type:"success"}),a.getUserCode();var s={userLicencesPath:e.data,userCode:t.userCode};i.a.authorizeService.updateAuthorizeInfo(s).then(function(e){"00"==e.code&&(a.$notify({message:"更新成功!",type:"success"}),a.reload())}),t.uploadAuthorizeFileDrawer=!1}})},cancelUploadAuthorizeFile:function(){this.uploadAuthorizeFileDrawer=!1}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"authorizeManagement"},[e._m(0),e._v(" "),a("div",{staticClass:"authorizeBody"},[e.listItem?[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.getUserCode}},[e._v("生成注册码")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.uploadAuthorize()}}},[e._v("上传授权文件")]),e._v(" "),a("p",{staticClass:"userCode"},[a("span",{staticClass:"title"},[e._v("注册码:")]),e._v(e._s(e.userCode))]),e._v(" "),a("p",{staticClass:"isAuthorize"},[a("span",{staticClass:"title"},[e._v("是否授权:")]),e._v(" "),0==e.listItem.isAuth?a("span",[e._v("否")]):e._e(),e._v(" "),1==e.listItem.isAuth?a("span",[e._v("是")]):e._e()]),e._v(" "),e.listItem.validStartDate&&e.listItem.validEndDate?a("div",{staticClass:"authorizeTime"},[a("p",[a("span",{staticClass:"title"},[e._v("授权开始时间:")]),e._v(e._s(e.listItem.validStartDate)+"\n        ")]),e._v(" "),a("p",[a("span",{staticClass:"title"},[e._v("授权结束时间:")]),e._v(e._s(e.listItem.validEndDate)+"\n        ")])]):e._e(),e._v(" "),a("el-drawer",{ref:"uploadAuthorizeFileDrawer",attrs:{title:"上传授权文件",visible:e.uploadAuthorizeFileDrawer,"with-header":!1,wrapperClosable:!1,"close-on-press-escape":!1,"destroy-on-close":!0,size:"40%"},on:{"update:visible":function(t){e.uploadAuthorizeFileDrawer=t}}},[a("div",{staticClass:"el-drawer-header"},[a("h3",[e._v("上传授权文件")])]),e._v(" "),a("div",{staticClass:"el-drawer-content"},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{drag:"",action:"/",limit:1,"http-request":e.uploadAuthorizeFile}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("\n              将文件拖到此处,或"),a("em",[e._v("点击上传")])])])],1),e._v(" "),a("div",{staticClass:"el-drawer-footer"},[a("el-button",{attrs:{plain:""},on:{click:function(t){return e.cancelUploadAuthorizeFile()}}},[e._v("取消")])],1)])]:e._e()],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"authorizeManagementHeader"},[t("p",[this._v("当前位置:授权管理")])])}]};var o=a("VU/8")(s,r,!1,function(e){a("DAWu")},null,null);t.default=o.exports}});
//# sourceMappingURL=8.c1849aa649a3df3b4a3c.js.map