webpackJsonp([6],{IRhI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("lHA8"),r=a.n(n),s=a("c/Tr"),o=a.n(s),i=a("mvHQ"),l=a.n(i),c=a("Xxa5"),d=a.n(c),u=a("exGp"),m=a.n(u),f=a("47tL"),h=a("NBFj"),p=a("z4xJ"),v={name:"manageAbout",components:{pagination:h.a},mixins:[p.a],inject:["reload"],data:function(){return{listItem:[],loading:!1,editDrawer:!1,menuDialog:!1,editForm:{name:"",status:""},ruleForm:{name:"",status:""},addRoleForm:{name:""},rules:{name:[{required:!0,message:"请输入角色名称",tirgger:"blur"}]},defaultProps:{children:"children",label:"label"},addRoleDrawer:!1,menuTreeData:[],menuList:[],setMenuList:[],setParMentList:[],checkedNodes:[],curpage:1,limit:10}},beforeMount:function(){this.getData()},methods:{getData:function(){var e=this;return m()(d.a.mark(function t(){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(a={}).queryInfo=e.ruleForm,e.getDataItem(e.addPageInfo(a));case 3:case"end":return t.stop()}},t,e)}))()},getDataItem:function(e){var t=this;f.a.systemService.roleManageList(e).then(function(a){if("00"==a.code){var n=a.data.count,r=e.pn,s=e.limit;t.listItem=a.data.items,t.curpage=r,t.limit=s,t.onGotPageData({totalElements:n,size:s,number:r})}})},search:function(e){var t=this,a={};a.queryInfo=e,this.loading=!0,this.addPageInfo(a),this.getDataItem(a),setTimeout(function(){t.loading=!1},500)},toTreeData:function(e){e.forEach(function(e){delete e.children});var t={};e.forEach(function(e){t[e.id]=e});var a=[];return e.forEach(function(e){var n=t[e.pId];n?(n.children||(n.children=[])).push(e):a.push(e)}),a},addRole:function(){this.addRoleDrawer=!0},saveaddRole:function(e,t){var a=this,n=t.name;this.$refs[e].validate(function(e){if(!e)return!1;var t={name:n};f.a.systemService.roleManageSave(t).then(function(e){"00"==e.code&&(a.reload(),a.$notify.success({message:"新增角色成功",showClose:!1,duration:1e3}))})})},cancelSaveaddRole:function(){this.addRoleDrawer=!1},edit:function(e){var t=this;this.editDrawer=!0,this.editId=e,f.a.systemService.roleManageDetail(e).then(function(e){"00"==e.code&&(t.editForm.name=e.data.name,"1"===e.data.status?t.editForm.status="是":"0"===e.data.status&&(t.editForm.status="否"))})},saveEditForm:function(e,t){var a=this,n=t.name,r={id:this.editId,name:n};f.a.systemService.roleManageSave(r).then(function(e){"00"==e.code&&(a.reload(),a.editDrawer=!1,a.$notify.success({message:"编辑成功",showClose:!1,duration:1e3}))})},handleCheck:function(e,t){this.checkedNodes=t.checkedNodes,this.checkedNodes.forEach(function(e){})},setting:function(e){var t=this;this.menuDialog=!0,this.setMenuId=e,f.a.systemService.roleManageSettingMenu(e).then(function(e){var a=e.data;a=JSON.parse(l()(a).replace(/name/g,"label")),t.menuTreeData=t.toTreeData(a);for(var n=0;n<t.menuTreeData.length;n++){if(t.menuTreeData[n].children)for(var s=0;s<t.menuTreeData[n].children.length;s++)t.menuTreeData[n].children[s].id.startsWith("T")&&(t.menuTreeData[n].children[s].id=t.menuTreeData[n].children[s].id);t.menuTreeData[n].id.startsWith("M")&&(t.menuTreeData[n].id=t.menuTreeData[n].id)}t.menuTreeData.forEach(function(e,a){e.children?e.children.forEach(function(e,a){1==e.checked&&(e.pId.startsWith("M")&&(t.setParMentList.push(e.pId),t.setParMentList=o()(new r.a(t.setParMentList))),t.setMenuList.push(e.id),t.setMenuList=o()(new r.a(t.setMenuList)))}):1==e.checked&&(t.setMenuList.push(e.id),t.setMenuList=o()(new r.a(t.setMenuList)))})})},refresh:function(){this.reload()},cancelForm:function(){this.editDrawer=!1},setMenuSave:function(){var e=this,t=this.setMenuId,a=this.checkedNodes,n=this.menuList;if(a&&0!=a.length)for(var s=0;s<a.length;s++)a[s].id.indexOf("T")||(a[s].id=a[s].id.replace("T",""),n.push(a[s].id),n=o()(new r.a(n)));new this.$messageTips(function(e){(0,e.confirm)({content:"确定要更新菜单列表吗?"})}).then(function(a){var r={btnList:[],itemList:n,roleId:t};f.a.systemService.roleManageSettingMenuSave(r).then(function(t){"00"==t.code&&(e.$notify({message:"更新成功",type:"success",duration:1e3}),e.reload(),e.menuDialog=!1)})})},resetForm:function(){},blockUp:function(e){var t=this;new this.$messageTips(function(e){(0,e.alert)({content:"确定要停用吗?",tip:"确定停用"})}).then(function(){f.a.systemService.roleManageBolockUp(e).then(function(e){"00"===e.code&&(t.reload(),t.$notify.success({message:"停用成功",type:"warning",showClose:!1,duration:1e3}))})})},launch:function(e){var t=this;new this.$messageTips(function(e){(0,e.alert)({content:"确定要启用吗?",tip:"确定启用"})}).then(function(){f.a.systemService.roleManageLaunch(e).then(function(e){"00"===e.code&&(t.reload(),t.$notify.success({message:"启用成功",showClose:!1,duration:1e3}))})})}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"roleManagement"},[e._m(0),e._v(" "),a("div",{staticClass:"searchForm"},[a("div",{staticClass:"searchBox"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm}},[a("el-input",{attrs:{placeholder:"请输入角色名称",size:"small"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}}),e._v(" "),a("el-select",{attrs:{placeholder:"是否有效",size:"small"},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"operateBox"},[a("el-tooltip",{attrs:{effect:"dark",content:"查询",placement:"top-start"}},[a("el-button",{staticClass:"searchButton",attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:function(t){return e.search(e.ruleForm)}}})],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"刷新",placement:"top-start"}},[a("el-button",{staticClass:"refreshButton",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-refresh-right",size:"small"},on:{click:function(t){return e.refresh()}}})],1),e._v(" "),a("el-button",{staticClass:"addRoleButton",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addRole()}}},[e._v("新增角色")]),e._v(" "),a("el-drawer",{ref:"addRoleDrawer",attrs:{title:"新增角色",visible:e.addRoleDrawer,"with-header":!1,wrapperClosable:!1,"close-on-press-escape":!1,size:"30%"},on:{"update:visible":function(t){e.addRoleDrawer=t},close:function(t){return e.resetForm("addRoleForm")}}},[a("div",{staticClass:"el-drawer-header"},[a("h3",[e._v("新增角色")])]),e._v(" "),a("div",{staticClass:"el-drawer-content"},[a("el-form",{ref:"addRoleForm",attrs:{model:e.addRoleForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{"auto-complete":"off",size:"small"},model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"el-drawer-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveaddRole("addRoleForm",e.addRoleForm)}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(t){return e.cancelSaveaddRole()}}},[e._v("取消")])],1)])],1)]),e._v(" "),a("div",{staticClass:"roleManagementBody"},[[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"listItem",attrs:{data:e.listItem,"element-loading-text":"加载中"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"角色名称",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"是否有效",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.status?a("span",[e._v("是")]):e._e(),e._v(" "),"0"===t.row.status?a("span",[e._v("否")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":!0,width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.createTime))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","show-overflow-tooltip":!0,width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.updateTime))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",content:"编辑",placement:"top-start"}},[a("i",{staticClass:"el-icon-edit-outline editIcon",on:{click:function(a){return e.edit(t.row.id)}}})]),e._v(" "),a("el-drawer",{ref:"editDrawer",attrs:{title:"编辑",visible:e.editDrawer,"with-header":!1,wrapperClosable:!1,"close-on-press-escape":!1,size:"40%"},on:{"update:visible":function(t){e.editDrawer=t}}},[a("div",{staticClass:"el-drawer-header"},[a("h3",[e._v("编辑")])]),e._v(" "),a("div",{staticClass:"el-drawer-content"},[a("el-form",{ref:"editForm",attrs:{model:e.editForm}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否有效"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"el-drawer-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveEditForm("editForm",e.editForm)}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.cancelForm}},[e._v("取消")])],1)]),e._v(" "),1==t.row.status?a("el-tooltip",{attrs:{effect:"dark",content:"设置菜单",placement:"top-start"}},[a("i",{staticClass:" el-icon-setting settingIcon",on:{click:function(a){return e.setting(t.row.id)}}})]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"菜单列表",visible:e.menuDialog,width:"20%"},on:{"update:visible":function(t){e.menuDialog=t}}},[a("el-tree",{attrs:{data:e.menuTreeData,"node-key":"id","show-checkbox":"","default-checked-keys":e.setMenuList,props:e.defaultProps},on:{check:e.handleCheck}}),e._v(" "),a("div",{staticClass:"el-dialog-footer",staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.setMenuSave}},[e._v("确定")])],1)],1),e._v(" "),1==t.row.status?a("el-tooltip",{attrs:{effect:"dark",content:"停用",placement:"top-start"}},[a("i",{staticClass:"el-icon-circle-close closeIcon",on:{click:function(a){return e.blockUp(t.row.id)}}})]):e._e(),e._v(" "),0==t.row.status?a("el-tooltip",{attrs:{effect:"dark",content:"启用",placement:"top-start"}},[a("i",{staticClass:"el-icon-circle-check checkIcon",on:{click:function(a){return e.launch(t.row.id)}}})]):e._e()]}}])})],1)]],2),e._v(" "),a("div",{staticClass:"roleManagementBase"},[a("pagination",{on:{pageChanged:e.onPageChanged}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"roleManagementHeader"},[t("p",[this._v("当前位置: 角色管理")])])}]};var w=a("VU/8")(v,g,!1,function(e){a("U3yR")},null,null);t.default=w.exports},U3yR:function(e,t){},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var n=a("FeBl"),r=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}}});
//# sourceMappingURL=6.2472f20cf853417e79ce.js.map